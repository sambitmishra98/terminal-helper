#!/bin/bash
#SBATCH --job-name=ompi-sanity
## ---------- heterogeneous request -----------------
## group-0  –  4× V100
#SBATCH --partition=all
#SBATCH --nodes=1
#SBATCH --gres=gpu:4
#SBATCH --ntasks-per-node=4        # 1 MPI-rank per GPU
#SBATCH --cpus-per-gpu=1
#SBATCH --gpu-bind=closest
#SBATCH --use-min-nodes
#SBATCH hetjob                     # ← separator
## group-1  –  3× MI100
#SBATCH --partition=amd
#SBATCH --nodes=1
#SBATCH --gres=gpu:3
#SBATCH --ntasks-per-node=3
#SBATCH --cpus-per-gpu=1
#SBATCH --gpu-bind=closest
#SBATCH --use-min-nodes
## ---------------------------------------------------
#SBATCH --time=00:10:00
#SBATCH --output=%x_%j.out
#SBATCH --error=%x_%j.err

### 1. load your mixed tool-chain
source /mnt/share/sambit98/.github/sambitmishra98/terminal-helper/\
lib/installers/installations/Spitfire/mixed/setup-login.sh

srun --mpi=pmi2 --het-group=0 -l hostname : --mpi=pmi2 --het-group=1 -l hostname
